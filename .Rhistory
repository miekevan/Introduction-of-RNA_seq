nC_des_fc_FDR_47_11 <- hits_anno %>% inner_join(nC_47_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_00 <- hits_anno %>% inner_join(nC_47_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_10 <- hits_anno %>% inner_join(nC_47_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_157_11 <- hits_anno %>% inner_join(nC_157_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_157_00 <- hits_anno %>% inner_join(nC_157_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_330_1 <- hits_anno %>% inner_join(nC_330_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_330_0 <- hits_anno %>% inner_join(nC_330_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_183_1 <- hits_anno %>% inner_join(nC_183_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_183_0 <- hits_anno %>% inner_join(nC_183_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_185_1 <- hits_anno %>% inner_join(nC_185_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
nC_des_fc_FDR_185_0 <- hits_anno %>% inner_join(nC_185_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
View(nC_des_fc_FDR_32_10)
library(dplyr)
library(tidyr)
library(pheatmap)
options(digits=2)
R.Version()
keep_fc_FDR_31 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.Sl","logFC.SlHa", "FDR.Ha","FDR.Sl","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_32 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.Sl", "FDR.Ha","FDR.Sl",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_47 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.SlHa", "FDR.Ha","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_157 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Sl","logFC.SlHa", "FDR.Sl","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_330 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_183 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_185 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
nC_des_fc_FDR_31_111 <- hits_anno %>% inner_join(nC_31_111, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_31_000 <- hits_anno %>% inner_join(nC_31_000, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_31_100 <- hits_anno %>% inner_join(nC_31_100, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_11 <- hits_anno %>% inner_join(nC_32_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_00 <- hits_anno %>% inner_join(nC_32_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_10 <- hits_anno %>% inner_join(nC_32_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_11 <- hits_anno %>% inner_join(nC_47_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_00 <- hits_anno %>% inner_join(nC_47_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_10 <- hits_anno %>% inner_join(nC_47_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_157_11 <- hits_anno %>% inner_join(nC_157_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_157_00 <- hits_anno %>% inner_join(nC_157_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_330_1 <- hits_anno %>% inner_join(nC_330_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_330_0 <- hits_anno %>% inner_join(nC_330_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_183_1 <- hits_anno %>% inner_join(nC_183_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_183_0 <- hits_anno %>% inner_join(nC_183_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_185_1 <- hits_anno %>% inner_join(nC_185_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
nC_des_fc_FDR_185_0 <- hits_anno %>% inner_join(nC_185_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
View(nC_des_fc_FDR_31_000)
View(nC_des_fc_FDR_31_100)
View(nC_des_fc_FDR_31_111)
View(nC_des_fc_FDR_31_111)
View(nC_des_fc_FDR_31_000)
View(nC_des_fc_FDR_47_00)
View(nC_des_fc_FDR_47_11)
View(nC_des_fc_FDR_31_111)
library(dplyr)
library(tidyr)
library(pheatmap)
options(digits=2)
R.Version()
keep_fc_FDR_31 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.Sl","logFC.SlHa", "FDR.Ha","FDR.Sl","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_32 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.Sl", "FDR.Ha","FDR.Sl",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_47 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.SlHa", "FDR.Ha","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_157 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Sl","logFC.SlHa", "FDR.Sl","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_330 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_183 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_185 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
nC_des_fc_FDR_31_111 <- hits_anno %>% inner_join(nC_31_111, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_31_000 <- hits_anno %>% inner_join(nC_31_000, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_31_100 <- hits_anno %>% inner_join(nC_31_100, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_11 <- hits_anno %>% inner_join(nC_32_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_00 <- hits_anno %>% inner_join(nC_32_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_10 <- hits_anno %>% inner_join(nC_32_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_11 <- hits_anno %>% inner_join(nC_47_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_00 <- hits_anno %>% inner_join(nC_47_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_10 <- hits_anno %>% inner_join(nC_47_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_157_11 <- hits_anno %>% inner_join(nC_157_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_157_00 <- hits_anno %>% inner_join(nC_157_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_330_1 <- hits_anno %>% inner_join(nC_330_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_330_0 <- hits_anno %>% inner_join(nC_330_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_183_1 <- hits_anno %>% inner_join(nC_183_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_183_0 <- hits_anno %>% inner_join(nC_183_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_185_1 <- hits_anno %>% inner_join(nC_185_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
nC_des_fc_FDR_185_0 <- hits_anno %>% inner_join(nC_185_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
View(nC_des_fc_FDR_32_11)
View(nC_des_fc_FDR_31_111)
View(nC_des_fc_FDR_32_11)
View(nC_des_fc_FDR_330_1)
View(nC_des_fc_FDR_183_1)
View(nC_des_fc_FDR_183_1)
View(nC_des_fc_FDR_183_0)
View(nC_des_fc_FDR_157_11)
View(nC_des_fc_FDR_157_00)
View(nC_des_fc_FDR_183_0)
knitr::opts_chunk$set(echo = TRUE)
getwd()
#[1] "C:/Users/Zilan/OneDrive - University of Helsinki/Kashif project/Norway samples project"
library(dplyr)
N5an3_2 <- read.table('./raw_counts/N5an3_2.tsv',sep = '\t', header = T)
View(N5an3_2)
colnames(N5an3_2)
keep_column <- c('id',"count")
N5an3_2 <- read.table('./raw_counts/N5an3_2.tsv',sep = '\t', header = T) %>% select(one_of(keep_column))
write.table(N5an3_2, file="./raw_counts/5Nan3.txt", sep="\t", quote=F, row.names = FALSE, col.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(edgeR)
library(DESeq2)
getwd()
#[1] "C:/Users/Zilan/OneDrive - University of Helsinki/Kashif project/Norway spruce_N"
#Pabies.targets<-read.delim("./RawCounts/fileDesc.txt")
Pabies.targets<-read.delim("./RawCounts/fileDesc1.txt")
#Pabies.targets<-read.delim("./RawCounts/fileDesc.txt")
Pabies.targets_1<-read.delim("./RawCounts/fileDesc1.txt")
#rownames(Pabies.targets)<-c('HA_SW_N11', 'HA_SW_N19', 'HA_PN_N20', 'HA_CS_N5', 'HA_CS_N13', 'HA_CS_N21', 'HA_ALL_N26', 'HP_SW_N6',  'HP_SW_N14', 'HP_SW_N22', 'HP_CS_N16', 'HP_PN_N23', 'HP_ALL_N27', 'CT_SW_N9', 'CT_SW_N17', 'CT_PN_N18', 'CT_SWPN_N25')
rownames(Pabies.targets_1)<-c('HA_SW_N11', 'HA_SW_N19', 'HA_PN_N20', 'HA_CS_N5', 'HA_CS_N13', 'HA_CS_N21', 'HA_ALL_N26', 'HP_SW_N6',  'HP_SW_N14', 'HP_SW_N22', 'HP_CS_N16', 'HP_PN_N23', 'HP_ALL_N27', 'CT_SW_N9', 'CT_SWPN_N25')
#Pabies.orig <- readDGE(Pabies.targets, header=F)
Pabies.orig_1 <- readDGE(Pabies.targets_1, header=F)
#dim(Pabies.orig)
dim(Pabies.orig_1)
Pabies.rawCount_1 <- Pabies.orig_1$count
dim(Pabies.rawCount_1)
head(Pabies.rawCount_1)
Condition_1 <- factor(c(rep("HA",7), rep("HP", 6), rep("CT", 2)))
Zone_1 <- factor(c(rep('sapwood', 2), rep('phenolic region',1),rep('conidiospore region',3), rep('All',1),rep('sapwood',3), rep('conidiospore region',1),
rep('phenolic region',1),rep('All',1), rep('sapwood',1),rep('sapwood+phenolic region',1)))
meta_1 <- data.frame(Zone_1,Condition_1, row.names = colnames(Pabies.orig_1$count))
Group_1 <- factor(paste(meta_1$Condition_1,meta$Zone_1,sep="_"))
cbind(meta_1,Group=Group_1)
View(meta)
View(meta_1)
Condition_1 <- factor(c(rep("HA",7), rep("HP", 6), rep("CT", 2)))
Zone_1 <- factor(c(rep('sapwood', 2), rep('phenolic region',1),rep('conidiospore region',3), rep('All',1),rep('sapwood',3), rep('conidiospore region',1),
rep('phenolic region',1),rep('All',1), rep('sapwood',1),rep('sapwood+phenolic region',1)))
meta_1 <- data.frame(Zone_1,Condition_1, row.names = colnames(Pabies.orig_1$count))
Group_1 <- factor(paste(meta_1$Condition_1,meta_1$Zone_1,sep="_"))
cbind(meta_1,Group=Group_1)
#colnames(Pabies.orig$count)
colnames(Pabies.orig_1$count)
load("C:/Users/Zilan/OneDrive - University of Helsinki/co-infection 2/Function annotation_2/FunAnaly_Goenrichment.RData")
setwd('C:/Users/Zilan/OneDrive - University of Helsinki/co-infection 2/Function annotation_2')
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GO.db")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("clusterProfiler")
library(dplyr)
library(tidyr)
library(data.table)
library(GO.db)
library(clusterProfiler)
library(enrichplot)
library(ggplot2)
library(scales)
Ha_geneList <- read.csv("Ha_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
Sl_geneList <- read.csv("Sl_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
SlHa_geneList <- read.csv("SlHa_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
Ha_geneList <- read.csv("Ha_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
Sl_geneList <- read.csv("Sl_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
SlHa_geneList <- read.csv("SlHa_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
View(Ha_geneList)
View(Sl_geneList)
View(SlHa_geneList)
best_single_hits <- read.table('./best_single_hits.txt', sep = '\t', header = T)
pine24_anno <- read.table("pine24_anno.txt", header = TRUE,  sep = '\t',quote = "", fill = TRUE)
View(best_single_hits)
pine24_anno <- read.table("pine24_anno.txt", header = TRUE,  sep = '\t',quote = "", fill = TRUE)
View(pine24_anno)
best_single_hits$Gene <- substr(best_single_hits$Gene, 1, nchar(best_single_hits$Gene)-2)
best_single_hits$trinity_id <- substr(best_single_hits$trinity_id, 1, nchar(best_single_hits$trinity_id)-3)
best_single_hits$trinity_id <- gsub('_', '', as.character(best_single_hits$trinity_id))
pine24_anno$trinity_id <- gsub('_', '', as.character(pine24_anno$trinity_id))
colnames(best_single_hits)
colnames(pine24_anno)
hits_anno <- inner_join(best_single_hits, pine24_anno, by = 'trinity_id')
colnames(hits_anno)
hits_anno_GO <- hits_anno[c(1,34)]
View(hits_anno_GO)
hits_anno_GO <- hits_anno_GO[, list(Gene.ontology.Ids = unlist(strsplit(Gene.ontology.Ids , "; "))), by = Gene]
hits_anno_GO <- data.table(hits_anno_GO)
hits_anno_GO <- hits_anno_GO[, list(Gene.ontology.Ids = unlist(strsplit(Gene.ontology.Ids , "; "))), by = Gene]
hits_GO <- hits_anno_GO[,c(2,1)]
View(hits_GO)
View(hits_anno)
Ha_geneList <- read.csv("Ha_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
Sl_geneList <- read.csv("Sl_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
SlHa_geneList <- read.csv("SlHa_vs_Ctr_gene_ID_list.txt", header = TRUE, sep = "\t")
goterms_1 <- Term(GOTERM)
goterms <- read.table('./goterms.txt', header = T, sep = '\t')
GoName <- go2term(goterms$GOs)
View(GoName)
Goont <- go2ont(goterms$GOs)
View(Goont)
View(Ha_geneList)
go_enr_res_Ha <- enricher(Ha_geneList$Gene, TERM2GENE=hits_GO,TERM2NAME = goterms, pvalueCutoff = 0.5, pAdjustMethod = "BH", qvalueCutoff = 0.5, minGSSize = 10,gson = NULL)
View(goterms)
go_Ha_ont <- go_enr_res_Ha %>% merge(Goont, by.x='ID', by.y ='go_id') %>% arrange (p.adjust)
View(go_Ha_ont)
go_Ha_MF <-go_Ha_ont[grep("MF", go_Ha_ont$Ontology), ]
View(go_Ha_MF)
View(hits_anno)
View(best_single_hits)
View(pine24_anno)
View(hits_anno_GO)
View(hits_GO)
View(hits_anno_GO)
View(Ha_geneList)
goterms_1 <- Term(GOTERM)
View(Ha_geneList)
View(go_Ha_MF)
go_Ha_MF_1 <- go_Ha_MF  %>% mutate( GeneRatio = Count/355) %>% select(one_of(keep_col_Ha)) %>% unite(GODescription, c(ID, Description)) %>%
mutate(condition = 'Ha')
library(dplyr)
library(tidyr)
library(data.table)
library(GO.db)
library(clusterProfiler)
library(enrichplot)
library(ggplot2)
library(scales)
keep_col_Ha <- c('ID','Description',"p.adjust","GeneRatio", 'condition')
go_Ha_MF_1 <- go_Ha_MF  %>% mutate( GeneRatio = Count/355) %>% select(one_of(keep_col_Ha)) %>% unite(GODescription, c(ID, Description)) %>%
mutate(condition = 'Ha')
colnames(go_Ha_MF_1)[2] <- "padjust"
keep_col_Sl <- c('ID','Description',"p.adjust","GeneRatio", 'condition')
go_Sl_MF_1 <- go_Sl_MF  %>% mutate( GeneRatio = Count/333) %>% select(one_of(keep_col_Sl)) %>% unite(GODescription, c(ID, Description)) %>%
mutate(condition = 'Sl')
View(go_Ha_MF_1)
View(go_Ha_MF)
load("C:/Users/Zilan/OneDrive - University of Helsinki/co-infection 2/Function annotation_2/function analysis_2-heatmap.RData")
keep_fc_FDR_31 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.Sl","logFC.SlHa", "FDR.Ha","FDR.Sl","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_32 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.Sl", "FDR.Ha","FDR.Sl",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_47 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Ha","logFC.SlHa", "FDR.Ha","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_157 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC.Sl","logFC.SlHa", "FDR.Sl","FDR.SlHa",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_330 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_183 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
keep_fc_FDR_185 <-  c('Gene',"Ctr1", "Ctr2","Ctr3","Ha1", "Ha2","Ha3","Sl1","Sl2","Sl3","SlHa1","SlHa2","SlHa3", "logFC", "FDR",'Protein.families','Protein.name','trinity_id')
nC_des_fc_FDR_31_111 <- hits_anno %>% inner_join(nC_31_111, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
library(dplyr)
library(tidyr)
library(pheatmap)
options(digits=2)
R.Version()
nC_des_fc_FDR_31_111 <- hits_anno %>% inner_join(nC_31_111, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_31_000 <- hits_anno %>% inner_join(nC_31_000, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_31_100 <- hits_anno %>% inner_join(nC_31_100, by = 'Gene') %>% select(one_of(keep_fc_FDR_31)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_11 <- hits_anno %>% inner_join(nC_32_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_00 <- hits_anno %>% inner_join(nC_32_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_32_10 <- hits_anno %>% inner_join(nC_32_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_32)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_11 <- hits_anno %>% inner_join(nC_47_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_00 <- hits_anno %>% inner_join(nC_47_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_47_10 <- hits_anno %>% inner_join(nC_47_10, by = 'Gene') %>% select(one_of(keep_fc_FDR_47)) %>% arrange(FDR.Ha)
nC_des_fc_FDR_157_11 <- hits_anno %>% inner_join(nC_157_11, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_157_00 <- hits_anno %>% inner_join(nC_157_00, by = 'Gene') %>% select(one_of(keep_fc_FDR_157)) %>% arrange(FDR.Sl)
nC_des_fc_FDR_330_1 <- hits_anno %>% inner_join(nC_330_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_330_0 <- hits_anno %>% inner_join(nC_330_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_330)) %>% arrange(FDR)
nC_des_fc_FDR_183_1 <- hits_anno %>% inner_join(nC_183_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_183_0 <- hits_anno %>% inner_join(nC_183_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_183)) %>% arrange(FDR)
nC_des_fc_FDR_185_1 <- hits_anno %>% inner_join(nC_185_1, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
nC_des_fc_FDR_185_0 <- hits_anno %>% inner_join(nC_185_0, by = 'Gene') %>% select(one_of(keep_fc_FDR_185)) %>% arrange(FDR)
Des_31_111 <- read.csv("./results/anno_results_review/FC_des_31_111.csv", header = TRUE)
Des_31_000 <- read.csv("./results/anno_results_review/FC_des_31_000.csv", header = TRUE)
Des_32_11 <- read.csv("./results/anno_results_review/FC_des_32_11.csv", header = TRUE)
Des_32_00 <- read.csv("./results/anno_results_review/FC_des_32_00.csv", header = TRUE)
Des_47_11 <- read.csv("./results/anno_results_review/FC_des_47_11.csv", header = TRUE)
Des_47_00 <- read.csv("./results/anno_results_review/FC_des_47_00.csv", header = TRUE)
Des_157_11 <- read.csv("./results/anno_results_review/FC_des_157_11.csv",header = TRUE)
Des_157_00 <- read.csv("./results/anno_results_review/FC_des_157_00.csv", header = TRUE)
Des_31_100 <- read.csv("./results/anno_results_review/FC_des_31_100.csv", header = TRUE)
Des_32_10 <- read.csv("./results/anno_results_review/FC_des_32_10.csv", header = TRUE)
Des_47_10 <- read.csv("./results/anno_results_review/FC_des_47_10.csv", header = TRUE)
Des_330_1 <- read.csv("./results/anno_results_review/FC_des_330_1.csv", header = TRUE)
Des_330_0 <- read.csv("./results/anno_results_review/FC_des_330_0.csv", header = TRUE)
Des_183_1 <- read.csv("./results/anno_results_review/FC_des_183_1.csv", header = TRUE)
Des_183_0 <- read.csv("./results/anno_results_review/FC_des_183_0.csv", header = TRUE)
Des_185_1 <- read.csv("./results/anno_results_review/FC_des_185_1.csv", header = TRUE)
Des_185_0 <- read.csv("./results/anno_results_review/FC_des_185_0.csv", header = TRUE)
FDR_31_000 <- FDR %>% right_join(Des_31_000, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_31_111 <- FDR %>% right_join(Des_31_111, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_32_00 <- FDR %>% right_join( Des_32_00, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_32_11 <- FDR %>% right_join(Des_32_11, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_47_00 <- FDR %>% right_join(Des_47_00, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_47_11 <- FDR %>% right_join(Des_47_11, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_157_00 <- FDR %>% right_join(Des_157_00, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_157_11 <- FDR %>% right_join(Des_157_11, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_31_100 <- FDR %>% right_join(Des_31_100, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_32_10 <- FDR %>% right_join(Des_32_10, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_47_10 <- FDR %>% right_join(Des_47_10, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_330_1 <- FDR %>% right_join(Des_330_1, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_330_0 <- FDR %>% right_join(Des_330_0, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_183_1 <- FDR %>% right_join(Des_183_1, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_183_0 <- FDR %>% right_join(Des_183_0, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_185_1 <- FDR %>% right_join(Des_185_1, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
FDR_185_0 <- FDR %>% right_join(Des_185_0, by = 'Gene') %>% select(one_of(sel_col_FDR)) %>% unite(GeneDescription, c(Gene, Protein.families))
Sim_fc_des_a <- bind_rows(Des_31_111, Des_31_000, Des_32_11, Des_32_00,Des_47_11,Des_47_00)
Dif_fc_des_a <- bind_rows(Des_31_100, Des_32_10, Des_47_10)
Sel_Col <- c('Gene', 'Protein.families', 'logFC.Ha', 'logFC.Sl', 'logFC.SlHa')
Sim_fc_des_asel <- Sim_fc_des_a %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Sim_fc_des_bsel <- Des_157_11 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Sim_fc_des_csel <- Des_157_00 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_asel <- Dif_fc_des_a %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_330_1 <- Des_330_1 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_330_0 <- Des_330_0 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_183_1 <- Des_183_1 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_183_0 <- Des_183_0 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_185_1 <- Des_185_1 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Dif_fc_des_185_0 <- Des_185_0 %>% select(one_of(Sel_Col)) %>% unite(GeneDescription, c(Gene, Protein.families))
Sim_FDR_a <- bind_rows(FDR_31_111, FDR_31_000, FDR_32_11, FDR_32_00,FDR_47_11, FDR_47_00)
Dif_FDR_a <- bind_rows(FDR_31_100, FDR_32_10, FDR_47_10)
Sim_fc_des_sel_a1 <- data.frame(Sim_fc_des_asel, row.names = 'GeneDescription')
Sim_fc_des_sel_a1<- as.matrix(Sim_fc_des_sel_a1)
Sim_fc_des_sel_b1 <- data.frame(Sim_fc_des_bsel, row.names = 'GeneDescription')
Sim_fc_des_sel_b1<- as.matrix(Sim_fc_des_sel_b1)
Sim_fc_des_sel_c1 <- data.frame(Sim_fc_des_csel, row.names = 'GeneDescription')
Sim_fc_des_sel_c1<- as.matrix(Sim_fc_des_sel_c1)
Sim_FDR_a1 <- data.frame(Sim_FDR_a, row.names = 'GeneDescription')
Sim_FDR_a1 <- as.matrix(Sim_FDR_a1)
Sim_FDR_b1 <- data.frame(FDR_157_11, row.names = 'GeneDescription')
Sim_FDR_b1 <- as.matrix(Sim_FDR_b1)
Sim_FDR_c1 <- data.frame(FDR_157_00, row.names = 'GeneDescription')
Sim_FDR_c1 <- as.matrix(Sim_FDR_c1)
Dif_fc_des_sel_a1 <- data.frame(Dif_fc_des_asel, row.names = 'GeneDescription')
Dif_fc_des_sel_a1<- as.matrix(Dif_fc_des_sel_a1)
Dif_330_1 <- data.frame(Dif_fc_des_330_1, row.names = 'GeneDescription')
Dif_330_1 <- as.matrix(Dif_330_1 )
Dif_330_1a <- data.frame(Dif_fc_des_330_1[1:100,], row.names = 'GeneDescription')
Dif_330_1a <- as.matrix(Dif_330_1a )
Dif_330_1b <- data.frame(Dif_fc_des_330_1[101:199,], row.names = 'GeneDescription')
Dif_330_1b <- as.matrix(Dif_330_1b )
Dif_330_0 <- data.frame(Dif_fc_des_330_0, row.names = 'GeneDescription')
Dif_330_0 <- as.matrix(Dif_330_0 )
Dif_183_1 <- data.frame(Dif_fc_des_183_1, row.names = 'GeneDescription')
Dif_183_1 <- as.matrix(Dif_183_1 )
Dif_183_0 <- data.frame(Dif_fc_des_183_0, row.names = 'GeneDescription')
Dif_183_0 <- as.matrix(Dif_183_0 )
Dif_185_1 <- data.frame(Dif_fc_des_185_1, row.names = 'GeneDescription')
Dif_185_1 <- as.matrix(Dif_185_1 )
Dif_185_0 <- data.frame(Dif_fc_des_185_0, row.names = 'GeneDescription')
Dif_185_0 <- as.matrix(Dif_185_0 )
Dif_FDR_a1 <- data.frame(Dif_FDR_a, row.names = 'GeneDescription')
Dif_FDR_a1 <- as.matrix(Dif_FDR_a1)
View(Fatty_acidD_logfpkm_geneDesc)
load("C:/Users/Zilan/OneDrive - University of Helsinki/Ha_simplicillium lamellicola project/HaDEGs_Heatmap/.RData")
load("C:/Users/Zilan/OneDrive - University of Helsinki/Ha_simplicillium lamellicola project/HaDEGs_Heatmap/.RData")
View(transporter_dw_A)
View(transporter_up_A)
transporter_updw <- bind_rows(transporter_up_A, transporter_dw_A)
library(dplyr)
transporter_updw <- bind_rows(transporter_up_A, transporter_dw_A)
View(transporter_updw)
transporter_updw_Desc <- unite(transporter_updw, 'geneDesc', c('gene_id', 'kogdefline'))
library(data.table)
library(tidyr)
library(pheatmap)
options(digits=2)
library(RColorBrewer)
transporter_updw_Desc <- unite(transporter_updw, 'geneDesc', c('gene_id', 'kogdefline'))
View(transporter_updw_Desc)
colnames(transporter_updw_Desc)
View(metabolism_dw)
transporter_updw_Desc_logfpkm <- ransporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
transporter_updw_Desc_logfpkm <- transporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
keep_col <- c("geneDesc", 'HaSl1_fpkm',"HaSl2_fpkm","HaSl3_fpkm","Ha1_fpkm","Ha2_fpkm", "Ha3_fpkm" )
keep_col_logfpkm <- c("geneDesc",'HaSl1_logfpkm',"HaSl2_logfpkm","HaSl3_logfpkm","Ha1_logfpkm","Ha2_logfpkm", "Ha3_logfpkm")
transporter_updw_Desc_logfpkm <- transporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
View(transporter_updw_Desc_logfpkm)
col_fun <- colorRampPalette(c("navy", "white", "firebrick3"))(50)
breaks <- seq(-2,2, 0.5)
View(transporter_updw_Desc)
keep_col <- c("geneDesc", 'HaSl1_fpkm',"HaSl2_fpkm","HaSl3_fpkm","Ha1_fpkm","Ha2_fpkm", "Ha3_fpkm" )
keep_col_logfpkm <- c("geneDesc",'HaSl1_logfpkm',"HaSl2_logfpkm","HaSl3_logfpkm","Ha1_logfpkm","Ha2_logfpkm", "Ha3_logfpkm", 'kogClass')
transporter_updw_Desc_logfpkm <- transporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
keep_col <- c("geneDesc", 'HaSl1_fpkm',"HaSl2_fpkm","HaSl3_fpkm","Ha1_fpkm","Ha2_fpkm", "Ha3_fpkm", 'ko gClass')
keep_col_logfpkm <- c("geneDesc",'HaSl1_logfpkm',"HaSl2_logfpkm","HaSl3_logfpkm","Ha1_logfpkm","Ha2_logfpkm", "Ha3_logfpkm", 'kogClass')
transporter_updw_Desc_logfpkm <- transporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
keep_col <- c("geneDesc", 'HaSl1_fpkm',"HaSl2_fpkm","HaSl3_fpkm","Ha1_fpkm","Ha2_fpkm", "Ha3_fpkm", 'kogClass')
keep_col_logfpkm <- c("geneDesc",'HaSl1_logfpkm',"HaSl2_logfpkm","HaSl3_logfpkm","Ha1_logfpkm","Ha2_logfpkm", "Ha3_logfpkm", 'kogClass')
transporter_updw_Desc_logfpkm <- transporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
annotation_row_1 = transporter_updw_Desc_logfpkm1$kogClass
annotation_row_1 = transporter_updw_Desc_logfpkm$kogClass
annotation_row_1 = dataframe(transporter_updw_Desc_logfpkm$kogClass)
annotation_row_1 = data.frame(transporter_updw_Desc_logfpkm$kogClass)
rownames(annotation_row_1) <- rownames(transporter_updw_Desc_logfpkm)
View(annotation_row_1)
rownames(annotation_row_1) <- transporter_updw_Desc_logfpkm$geneDesc
col_fun <- colorRampPalette(c("navy", "white", "firebrick3"))(50)
breaks <- seq(-2,2, 0.5)
transporter_updw_Desc_logfpkm1 <- data.frame(transporter_updw_Desc_logfpkm, row.names = 'geneDesc')
transporter_updw_Desc_logfpkm1<- as.matrix(transporter_updw_Desc_logfpkm1)
labels_col = c("HaSl1", "HaSl2", 'HaSl3', 'Ha1', 'Ha2', 'Ha3')
annotation_row_1 = data.frame(transporter_updw_Desc_logfpkm$kogClass)
rownames(annotation_row_1) <- transporter_updw_Desc_logfpkm$geneDesc
pdf("./results/heatmap_transporter_1.pdf")
pheatmap(transporter_updw_Desc_logfpkm1, cluster_cols = F, cluster_rows = T, , color = col_fun,annotation_row = annotation_row_1, cellwidth = 20, cellheight = 4, fontsize = 7,fontsize_row = 4,main = "transporters",labels_col = labels_col,angle_col = c("45"),fontsize_number = 4,, scale = "row")
transporter_updw_Desc_logfpkm1 <- data.frame(transporter_updw_Desc_logfpkm, row.names = 'geneDesc')
transporter_updw_Desc_logfpkm1<- as.matrix(transporter_updw_Desc_logfpkm1)
labels_col = c("HaSl1", "HaSl2", 'HaSl3', 'Ha1', 'Ha2', 'Ha3')
annotation_row_1 = data.frame(transporter_updw_Desc_logfpkm$kogClass)
rownames(annotation_row_1) <- transporter_updw_Desc_logfpkm$geneDesc
pdf("./results/heatmap_transporter_1.pdf")
pheatmap(transporter_updw_Desc_logfpkm1, cluster_cols = F, cluster_rows = T, , color = col_fun, cellwidth = 20, cellheight = 4, fontsize = 7,fontsize_row = 4,main = "transporters",labels_col = labels_col,angle_col = c("45"),fontsize_number = 4,, scale = "row")
keep_col <- c("geneDesc", 'HaSl1_fpkm',"HaSl2_fpkm","HaSl3_fpkm","Ha1_fpkm","Ha2_fpkm", "Ha3_fpkm")
keep_col_logfpkm <- c("geneDesc",'HaSl1_logfpkm',"HaSl2_logfpkm","HaSl3_logfpkm","Ha1_logfpkm","Ha2_logfpkm", "Ha3_logfpkm")
transporter_updw_Desc_logfpkm <- transporter_updw_Desc %>%
select(one_of(keep_col))  %>%
dplyr::mutate( HaSl1_logfpkm= log2(HaSl1_fpkm+1),HaSl2_logfpkm= log2(HaSl2_fpkm+1),HaSl3_logfpkm= log2(HaSl3_fpkm+1), Ha1_logfpkm= log2(Ha1_fpkm+1),Ha2_logfpkm= log2(Ha2_fpkm+1),Ha3_logfpkm= log2(Ha3_fpkm+1)) %>%
select(one_of(keep_col_logfpkm))
transporter_updw_Desc_logfpkm1 <- data.frame(transporter_updw_Desc_logfpkm, row.names = 'geneDesc')
transporter_updw_Desc_logfpkm1<- as.matrix(transporter_updw_Desc_logfpkm1)
pdf("./results/heatmap_transporter_1.pdf")
pheatmap(transporter_updw_Desc_logfpkm1, cluster_cols = F, cluster_rows = T, , color = col_fun, cellwidth = 20, cellheight = 4, fontsize = 7,fontsize_row = 4,main = "transporters",labels_col = labels_col,angle_col = c("45"),fontsize_number = 4,, scale = "row")
dev.off()
pdf("./results/heatmap_transporter_1.pdf")
pheatmap(transporter_updw_Desc_logfpkm1, cluster_cols = T, cluster_rows = F, , color = col_fun, cellwidth = 20, annotation_row = annotation_row_1, cellheight = 4, fontsize = 7,fontsize_row = 4,main = "transporters",labels_col = labels_col,angle_col = c("45"),fontsize_number = 4,, scale = "row")
dev.off()
pdf("./results/heatmap_transporter_2.pdf")
pheatmap(transporter_updw_Desc_logfpkm1, cluster_cols = F, cluster_rows = T, , color = col_fun, cellwidth = 20, annotation_row = annotation_row_1, cellheight = 4, fontsize = 7,fontsize_row = 4,main = "transporters",labels_col = labels_col,angle_col = c("45"),fontsize_number = 4,, scale = "row")
dev.off()
f = anno_barplot(rnorm(10))
library(ComplexHeatmap)
f = anno_barplot(rnorm(10))
grid.newpage(); f(1:10)
f = anno_barplot(rnorm(10), which = "row")
grid.newpage(); f(1:10)
f = anno_barplot(rnorm(10))
grid.newpage(); f(1:10)
f = anno_barplot(rnorm(10), which = "row")
grid.newpage(); f(1:10)
load("C:/Users/Zilan/OneDrive - University of Helsinki/co-infection 2/Function annotation_2/.RData")
View(nC_des_fc_FDR_157_00)
library(dplyr)
library(tidyr)
library(pheatmap)
options(digits=2)
R.Version()
fc_Ha = read.table('./data/lrt.Ha_vs_Ctr.txt',  sep = '\t', header = T)
fc_Sl = read.table('./data/lrt.Sl_vs_Ctr.txt',  sep = '\t', header = T)
fc_SlHa = read.table('./data/lrt.SlHa_vs_Ctr.txt',  sep = '\t', header = T)
View(fc_Ha_Sl)
View(FC_des_157_00)
View(nC_des_fc_FDR_157_00)
annotation_row_a = data.frame(expression=factor(rep(c("a_Ha.Sl.SlHa:+++","b_Ha.Sl.SlHa:---", "c_Ha.Sl:++","d_Ha.Sl:--","e_Ha.SlHa:++","f_Ha.SlHa:--"), c(16,3,4,2,23,11))))
View(annotation_row_a)
View(nC_des_fc_FDR_157_00)
View(metabolism_dw)
View(transporter_updw_Desc)
#pdf("./results/heatmap_transporter_2.pdf")
pheatmap(transporter_updw_Desc_logfpkm1,
cluster_cols = T,
cluster_rows = F,
color = col_fun,
cellwidth = 20,
annotation_row = annotation_row_1,
annotation_colors = annotation_colors,
cellheight = 4,
fontsize = 7,
fontsize_row = 4,
main = "transporters",
labels_col = labels_col,
angle_col = '45',
fontsize_number = 4,
scale = "row")
knitr::opts_chunk$set(echo = TRUE)
R.Version()#the code in the code chunk will not be run.
R.Version()#the code in the code chunk will not be run.
knitr::opts_chunk$set(echo = TRUE)
R.Version()#the code in the code chunk will not be run.
R.Version()
R.Version()
knitr::opts_chunk$set(echo = TRUE)
R.Version()#the code in the code chunk will not be run.
R.Version()#the code in the code chunk will not be run.
setwd('C:/Users/Zilan/OneDrive - University of Helsinki/ZilanWen Github/RNA-seq_Differential-Gene-Expression-Analysis')
setwd('C:/Users/Zilan/OneDrive - University of Helsinki/ZilanWen Github/RNA-seq_Differential-Gene-Expression-Analysis')
Coinfection.targets<-read.delim("./data/fileDesc.txt")
View(Coinfection.targets)
rownames(Coinfection.targets)<-c("Ha1","Ha2","Ha3","Ctr1","Ctr2","Ctr3")
View(Coinfection.targets)
library(edgeR)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("edgeR")
library(edgeR)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
BiocManager::install("edgeR")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2",force = TRUE)
BiocManager::install("edgeR",force = TRUE)
setwd("C:/Users/Zilan/OneDrive - University of Helsinki/ZilanWen Github/RNA-seq_Differential-Gene-Expression-Analysis")
Coinfection.targets<-read.delim("./data/fileDesc.txt")
```{r}
View(Coinfection.targets)
```{r}
```{r}
